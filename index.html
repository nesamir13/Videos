<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Prueba de Javascript</title>
</head>
<body>

 <h1 align="center">
  <script languaje="javascript" type="text/javascript">
    document.write ("Primer Ejemplo")
  </script>
</h1>

<Label>Nombres:</Label>
<input type="text" id="nombre" >
<br><br>

<label>Nota P1:</label>
<input type="number" id="nota1" >
<br><br>

<label> Nota P2:</label>
<input type="number" id="nota2">

<button class="btn waves-effect waves-light blue" id="sumar" >
  Agregar
</button>

<ul id="lista"></ul>
<table   id ="tab" border="1">
  <thead>
<tr>
  <td>Nombres</td>
  <td>Nota 1</td>
  <td>Nota 2</td>
  <td>Promedio</td>
  <td>Eliminar</td>
  <td>Editar</td>
</tr>
  </thead>
  <tbody id="contener">
  </tbody>
</table>
<h2 id="promedio"></h2>

<script>
  document.getElementById("sumar").addEventListener("click",sumar)
 
   /* function sumar() {
        var n1 = document.getElementById('nota1').value;
        var n2 = document.getElementById('nota2').value;
        var nombre = document.getElementById('nombre').value;
        var promedio = (parseInt(n1) + parseInt(n2))/2;
        document.getElementById("lista").innerHTML+=`
        <li>${nombre}: ${n1} +  ${n2} = ${promedio}
          <button id="eliminar">Eliminar</button>
        </li>`*/
        var total = 0;
        var contador= 0;
        var valorFinal= 0;
        var contador1=0;
        //var promedio=0;
   function sumar() {
        var n1 = document.getElementById('nota1').value;
        var n2 = document.getElementById('nota2').value;
        var nombre = document.getElementById('nombre').value.toUpperCase();
     
   if (n1 =="" || n2 == "" || nombre == "") {
     alert("Ingrese datos");
     fFoco()
   } else 
          if ((n1 > 1) && (n1 <=100) && (n2 > 1) && (n2 <= 100)) {
        var promedio = (parseInt(n1) + parseInt(n2))/2;
        contador += 1;
        total+=promedio ;
        valorFinal=total/contador;
        if (promedio < 60){
          document.getElementById("contener").innerHTML+=`
        <tr>
          <td >${nombre}</td>
          <td >${n1}</td>
          <td >${n2}</td>
          <td style="color:red" id="prom">${promedio}</td>
          <td ><button id="eliminar">Eliminar</button></td>
          <td ><button id="editar">Editar</button></td>
        </tr>` 
        }else {
        document.getElementById("contener").innerHTML+=`
      
        <tr>
          <td>${nombre}</td>
          <td>${n1}</td>
          <td>${n2}</td>
          <td id="prom">${promedio}</td>
          <td><button id="eliminar">Eliminar</button></td>
          <td ><button id="editar">Editar</button></td>
        </tr>`
      }
      if (valorFinal < 60 ) {

        document.getElementById("promedio").innerHTML=`El promedio Total es:<span style="color:red"> ${valorFinal.toFixed(2)}</span>` ; 
       
     }else {
      document.getElementById("promedio").innerHTML=`El promedio Total es: ${valorFinal.toFixed(2)}`;
       }
        fFoco()
        verDatos();
        
      }else{
        alert("valores mayor que cero y menor que 100");
        fFoco()
      }    
  }
    function verDatos() {
    
      let elimina = document.querySelectorAll("#eliminar");
      Array.from(elimina).forEach(function (elemento) {
        elemento.addEventListener("click", function (e) {
          //console.log(document.getElementById("prom").innerText);
        // / console.log(e.target.parentNode.parentNode.children[3].textContent);
       
         var valorcelda = e.target.parentNode.parentNode.children[3].textContent;
          //console.log("valor celda: "+ valorcelda);
          //console.log("valor total." + total);
          total = total - valorcelda;
        // console.log("valor de valor final:" + total);
          if (total == 0) {
            total= 0;
            contador=0;
            document.getElementById("promedio").innerHTML=`El promedio Total es: ${total.toFixed(2)}`;
            e.target.parentNode.parentNode.remove(); 
          }else{
           if (total < 60 ) {
            document.getElementById("promedio").innerHTML=`El promedio Total es:<span style="color:red"> ${total.toFixed(2)}</span>` ; 
            contador-=1;
           }else {
           document.getElementById("promedio").innerHTML=`El promedio Total es: ${total.toFixed(2)}`;
           contador-=1;
              }
         // console.log(e.target.parentNode.parentNode)
          e.target.parentNode.parentNode.remove(); 
        }
        })
      })
      
    }
function fFoco()
{
var nombre = document.getElementById("nombre");
var n1= document.getElementById("nota1");
var n2 = document.getElementById("nota2");
nombre.value = "";
nombre.focus();
// nombre.focus();
n1.value="";
n2.value="";         
}

function editar(){
  var valorcelda = e.target.parentNode.parentNode.children[0].textContent;
  var valorcelda1 = e.target.parentNode.parentNode.children[1].textContent;
  var valorcelda2 = e.target.parentNode.parentNode.children[2].textContent;
  var valorcelda3 = e.target.parentNode.parentNode.children[3].textContent;
}


</script>
</body>
</html>